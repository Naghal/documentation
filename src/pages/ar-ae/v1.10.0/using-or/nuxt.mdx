---
العنوان: "استخدام OpenReplay مع Nuxt"
metaTitle: "إضافة محلل OpenReplay إلى تطبيق Nuxt.js الخاص بك"
metaDescription: "تعلم كيفية الحصول على المحلل الذي يعمل في تطبيق Nuxt الخاص بك"
---
استيراد GoDeeperFooter من '~/components/go-deeper-footer.astro'

الحصول على المحلل للعمل في تطبيق Nuxt بسيط جدا.

## إضافة شفرة التتبع

بينما يمكنك الحصول على نسخة للنسخ واللصق مباشرة من المنصة عند إنشاء مشروع جديد، فإن هذه الشفرة قصيرة جدا وقد لا تتبع أفضل الممارسات المتوقعة من فريقك أو شركتك.

لذلك بدلاً من ذلك، يمكنك محاولة تجزئة الشفرة المقدمة مثل هذا:


```jsx
import Tracker from '@openreplay/tracker';
import {v4 as uuidV4} from 'uuid'

function defaultGetUserId() {
   return uuidV4() 
}

export function startTracker(config) {

    console.log("Starting tracker...")

    const getUserId = (config?.userIdEnabled && config?.getUserId) ? config.getUserId : defaultGetUserId
    let userId = null;

    const trackerConfig = {
        projectKey: config?.projectKey
    }

    const tracker = new Tracker(trackerConfig);

    if(config?.userIdEnabled) {
        userId = getUserId()
        tracker.setUserID(userId)
    }

    tracker.start();
    return {
        tracker,
        userId
    }
}
```


تقوم هذه الوظيفة بإدارة المحلل واستدعاء طريقة البدء، مما يجعل الأشياء قادمة.

يتطلب هذا الدالة أيضًا عبارة عن "تكوين" يمكنك توسيعه لميزات في المستقبل. يظهر هذا المثال لك كيفية تمكين ، اختياريًا ، القدرة على تحديد المستخدمين بشكل فريد. يمكنك استخدام UUID الافتراضي الذي سيكون فريدًا لكل مستخدم كل مرة يزورون الصفحة. يمكنك بدلاً من ذلك توفير دالة `getUserId` مخصصة كجزء من التكوين.

مع دالة مخصصة لديك، يمكنك توفير معرف العميل لمتجرك أو عنوان البريد الإلكتروني للمستخدم أو أي شيء يحدد المستخدم بشكل فريد في تطبيقك. بهذه الطريقة، يمكنك تتبع تشغيلات جلساتهم عبر الوقت في حالة وجود مشكلة خاصة لم يقوم أحد بالإبلاغ عنها.

في هذا المثال، من المتوقع أن يتم تمرير مفتاح المشروع الذي يمكنك الحصول عليه من واجهة مشروع OpenReplay داخل كائن التكوين على مفتاح `projectKey`.

## كتابة برنامج إضافي محدود إلى العميل

لاستخدام دالة `startTracker`، سترغب في إنشاء برنامج إضافي محدود إلى العميل داخل دليل `plugins` لمشروع Nuxt الخاص بك.

تأكد من إضافة اللاحقة `.client` إلى اسم ملف برنامج الإضافي الخاص بك. وهذا لضمان تحميله فقط على العميل.

قد يشبه كود برنامج الإضافي هذا:


```jsx
import {startTracker} from '../utils/tracker'

export default defineNuxtPlugin( (nuxtApp) => {
    
    return {
        provide: {
            startTracking: () => {
                let config = useRuntimeConfig().public
                
                let {userId} = startTracker({
                    userIdEnabled: true,
                    projectKey: config.openreplayProjectKey
                })
                //Optional if you need it
                let uid = useUserId()
                uid.value = userId
            }
        }
    }
})
```


إذا كنت ترغب في قراءة المزيد حول إنشاء برامج إضافية Nuxt، يمكنك التحقق من [وثائقهم](https://v3.nuxtjs.org/guide/directory-structure/plugins).

الآن، يوفر هذا البرنامج الإضافي دالة تسمى `startTracking`، والتي تقوم باستدعاء دالة `startTracker` التي حددناها من قبل. ولكن أهم شيء، داخل كود برنامج الإضافي، يمكنك الحصول على متغير البيئة الذي قمت بتخزين مفتاح المشروع فيه. استذكر، يجب عدم تشفير هذه المعلومات داخل مشروعك لأسباب أمنية.

من خلال دالة `useRuntimeConfig` يمكنك الوصول إلى المتغيرات العامة. في هذا المثال، أنا أوصل إلى `openreplayProjectKey` الذي تم تعري
```jsx
<script setup>
onMounted( () => {
  const {$startTracking} = useNuxtApp()
  $startTracking()
})
</script>

<template>
  <div>
    <NuxtPage />
  </div>
</template>
```
