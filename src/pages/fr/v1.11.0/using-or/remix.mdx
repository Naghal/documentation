---
titre: "Utiliser OpenReplay avec Remix"
metaTitle: "Utiliser le suiveur Ã  l'intÃ©rieur d'un projet Remix"
metaDescription: "Apprenez comment commencer Ã  suivre vos utilisateurs sur votre projet Remix"
---

import GoDeeperFooter from '~/components/go-deeper-footer.astro'

L'installation du suiveur OpenReplay dans un projet basÃ© sur Remix est relativement simple.

Avec votre projet Remix prÃªt, recherchez le fichier `root.jsx` dans le dossier `app` et incluez le code SSR fourni par OpenReplay lorsque vous avez crÃ©Ã© le projet sur la plateforme.

## Ã‰tape 1. Obtenir le code

Vous pouvez certainement utiliser le code prÃ©sentÃ© par la plateforme, ce qui reprÃ©senterait le minimum nÃ©cessaire pour commencer. Si vous le faites, assurez-vous de sÃ©lectionner l'option "Server-Side-Rendered (SSR)" comme indiquÃ© ci-dessous.

![snippet-code-screenshot.jpg](./images/snippet-code-screenshot.jpg)

Mais pour cet exemple, nous allons crÃ©er un module d'exemple que nous enregistrerons sous le nom de `tracker.ts` dans le dossier `app`. Ce module exportera une fonction appelÃ©e `startTracker` qui instanciera le suiveur et le lancera.


```jsx
import {v4 as uuidV4} from 'uuid'
import Tracker from '@openreplay/tracker'

function defaultGetUserId() {
    return uuidV4() 
}

type TrackerConfig = {
    projectKey: string,
    userIdEnabled?: boolean,
    getUserId?: () => string
}

export function startTracker(config: TrackerConfig) {
    let tracker = null;
    let userId = "";
   
    console.log("Starting tracker...")
    console.log("Custom configuration received: ", config)
        
    const getUserId = (config?.userIdEnabled && config?.getUserId) ? config.getUserId : defaultGetUserId
        
    const trackerConfig: TrackerConfig = {
        projectKey: config?.projectKey
    }
        
    console.log("Tracker configuration")
    console.log(trackerConfig)
    tracker = new Tracker(trackerConfig);
        
    if(config?.userIdEnabled) {
        userId = getUserId()
        tracker.setUserID(userId)
    }
     
    tracker.start();
      
    return {
        tracker,
        userId
    }
}
```


Si vous rencontrez des problÃ¨mes lors de l'importation du module Tracker d'OpenReplay de cette faÃ§on, envisagez d'utiliser une importation dynamique, comme ceci:


```jsx
import {v4 as uuidV4} from 'uuid'

function defaultGetUserId() {
    return uuidV4() 
}

type TrackerConfig = {
    projectKey: string,
    userIdEnabled?: boolean,
    getUserId?: () => string
}

export function startTracker(config: TrackerConfig) {
    let tracker = null;
    let Tracker = null
    let userId = "";
    
    (async () => {
				//dynamic import 
        Tracker  = (await import('@openreplay/tracker')).default 
        console.log("Starting tracker...")
        console.log("Custom configuration received: ", config)
        
        const getUserId = (config?.userIdEnabled && config?.getUserId) ? config.getUserId : defaultGetUserId
        
        const trackerConfig: TrackerConfig = {
            projectKey: config?.projectKey
        }
        
        console.log("Tracker configuration")
        console.log(trackerConfig)
        tracker = new Tracker(trackerConfig);
        
        if(config?.userIdEnabled) {
            userId = getUserId()
            tracker.setUserID(userId)
        }
        
        
        tracker.start();
        
    })()
    
    return {
        tracker,
        userId
    }
}
```


ðŸ’¡**Note pour les utilisateurs auto-hÃ©bergÃ©s:** si vous utilisez la version auto-hÃ©bergÃ©e d'OpenReplay, vous devrez Ã©galement spÃ©cifier la propriÃ©tÃ© de configuration `ingestPoint`. Cette propriÃ©tÃ© spÃ©cifie le point d'ingestion des donnÃ©es du suiveur. Les utilisateurs du Cloud n'ont pas besoin de cela, car par dÃ©faut le suiveur saura oÃ¹ se trouve la version SaaS de ce point d'extrÃ©mitÃ©, mais si vous l'hÃ©bergez vous-mÃªme, vous devrez le spÃ©cifier (ce devrait Ãªtre quelque chose comme `https://openreplay.mydomain.com/ingest`)

## Ã‰tape 2. Ajouter le code et le suiveur Ã  votre projet

Maintenant que c'est fait, vous devez installer le paquet de suiveur pour votre projet en utilisant:


```markdown
$ npm install @openreplay/tracker
```


Vous devrez Ã©galement installer le [paquet uuid](https://www.npmjs.com/package/uuid) pour vous assurer que le code ci-dessus fonctionne tel quel.

Une fois cela fait, nous sommes presque prÃªts Ã  commencer le suivi, mais nous devons toujours configurer la **clÃ© du projet** en tant que variable ENV et passer d'une maniÃ¨re ou d'une autre Ã  l'objet `config` reÃ§u dans la fonction `startTracker`.

### Chargement des variables ENV dans Remix

Les variables ENV sont accessibles dans le back-end, nous allons donc profiter de la fonction `loader` qui peut Ãªtre utilisÃ©e pour charger des donnÃ©es externes, y compris les variables ENV.

Et ensuite, nous utiliserons le hook `useLoaderData` pour que, aprÃ¨s l'hydratation, notre composant ait accÃ¨s aux donnÃ©es chargÃ©es.

Dans notre fichier root.tsx (ou jsx si vous n'utilisez pas TypeScript), ajoutez cette fonction:


```tsx
type LoaderData = {
  ENV: {
    projectKey: string | undefined
  }
};

export const loader: LoaderFunction = async ({ }) => {
  return json<LoaderData>({
    ENV: {
      projectKey: process.env.OPENREPLAY_PROJECT_KEY
    }
  });
};
```


Remarquez comment nous configurons notre clÃ© de projet Ã  l'intÃ©rieur de la variable ENV `OPENREPLAY_PROJECT_KEY`.

En le retournant comme partie de l'exÃ©cution de la fonction `loader`, nous pouvons ensuite utiliser le hook `useLoaderData` Ã  l'intÃ©rieur du composant principal, comme ceci:


```tsx
export default function App() {

  let loaderData = useLoaderData()

  useEffect(() => {
    startTracker({
      projectKey:  loaderData.ENV.projectKey
    })
  }, []) 

  return (
    <html lang="en">
      <head>
        <Meta />
        <Links />
      </head>
      <body>
        <Outlet />
        <ScrollRestoration />
        <Scripts />
        <LiveReload />
      </body>
    </html>
  );
}
```

